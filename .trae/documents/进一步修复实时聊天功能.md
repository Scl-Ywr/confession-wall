## 进一步修复实时聊天功能

### 问题分析
聊天记录仍然需要手动刷新才能显示，无法实时获取最新消息。经过前面的修复，可能的原因包括：
1. Supabase 控制台中实时功能未启用
2. 表的 RLS 策略不允许实时订阅
3. 表的 WAL 级别设置不正确
4. 通道订阅方式仍有问题
5. 过滤条件可能存在问题
6. 权限问题
7. 网络问题

### 修复方案

#### 1. 检查 Supabase 控制台配置
- 检查实时功能是否启用
- 检查表的 RLS 策略是否允许实时订阅
- 检查表的 WAL 级别设置

#### 2. 使用更简单的实时订阅方式
- 尝试不使用过滤条件，订阅所有消息事件
- 尝试使用不同的通道名称
- 尝试使用不同的事件类型

#### 3. 检查 RLS 策略
- 确保表的 RLS 策略允许 SELECT 操作
- 确保表的 RLS 策略允许实时订阅

#### 4. 尝试使用 Supabase 客户端的其他方法
- 尝试使用 `from` 方法创建实时订阅
- 尝试使用 `on` 方法直接订阅事件

#### 5. 检查网络连接
- 检查网络连接是否正常
- 检查防火墙设置

#### 6. 尝试使用第三方工具测试实时功能
- 使用 Supabase 控制台的实时监听器测试功能
- 使用 Postman 或其他工具测试实时功能

### 实施步骤

1. **检查 Supabase 控制台配置**
   - 登录 Supabase 控制台
   - 检查实时功能是否启用
   - 检查表的 RLS 策略
   - 检查表的 WAL 级别设置

2. **使用更简单的实时订阅方式**
   - 修改 `src/components/ChatInterface.tsx`，使用更简单的实时订阅方式
   - 修改 `src/app/chat/group/[groupId]/page.tsx`，使用更简单的实时订阅方式

3. **检查 RLS 策略**
   - 确保表的 RLS 策略允许 SELECT 操作
   - 确保表的 RLS 策略允许实时订阅

4. **测试实时功能**
   - 使用 Supabase 控制台的实时监听器测试功能
   - 测试私聊和群聊的实时消息功能

5. **优化代码**
   - 简化实时订阅代码
   - 确保代码的正确性
   - 添加更多调试日志

### 预期效果

通过以上修复，聊天记录应该能够实时自动获取最新消息，不需要手动刷新。